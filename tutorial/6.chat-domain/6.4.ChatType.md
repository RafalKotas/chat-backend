# 6.4 `ChatType` (Enum)

`ChatType` defines **the structural type of chat** in the system.<br>
Each `Chat` entity is assigned one of these types, which determines how the chat behaves and how participants 
are managed.

This enum allows the backend to distinguish between:

- **1:1 direct conversations**
- **multi-user group chats**

---

## ‚úî Enum Definition

```java
package com.chatapp.chat.chat;

public enum ChatType {
    DIRECT,
    GROUP
}
```

---

## üìù Purpose
`ChatType` categorizes chats into two fundamentally different modes of communication:
- **DIRECT** ‚Üí private, peer-to-peer conversations
- **GROUP** ‚Üí multi-user chat rooms with roles and membership management

This distinction is essential because **the rules, persistence logic, and UI behaviors differ** depending on chat type.

---

## üìå Types Explained

---

### 1. `DIRECT`

Represents a **private 1-to-1 chat** between exactly two users.

### Characteristics:
- Exactly **two** participants
- Cannot add or remove users after creation
- No admin roles (all participants are equal)
- A direct chat between two users is **unique**
  - `ChatService` prevents duplicates using:
  ```java
  chatRepository.findDirectChatBetweenUsers(...)
  ```
- Chat name is typically **null** or generated on the frontend (e.g. showing the partner's name)

### User for:
- private messaging
- encrypted end-to-end flows (possible future extension)
- DM functionality in apps like Messenger, WhatsApp, Slack

---

### 2. `GROUP`

Represents a **multi-user chat room.**

### Characteristics:
- Can contain **multiple participants**
- Supports roles (`MEMBER`, `ADMIN`)
- Allows adding or removing users:
    ```java
    chatService.addUserToGroup(...)
    chatService.removeUserFromGroup(...)
    ```
- Has a `name` field
- Admin or owner can manage membership

Used for:
- team chats
- class/group messaging
- community rooms
- announcement channels

---

## üîÑ Where `ChatType` Is Used

### ‚úì In the `Chat` entity

```java
@Enumerated(EnumType.STRING)
@Column(nullable = false)
private ChatType type;
```

Determines the chat's structural rules.

---

### In `ChatService`

Controls operations such as:
- Preventing adding/removing users in DIRECT chats
- Setting `ADMIN` for group creator
- Handling different creation workflows

Examples:

```java
if (chat.getType() != ChatType.GROUP) {
    throw new UnauthorizedChatOperationException("Cannot add users to direct chat");
}
```

```java
Chat.builder().type(ChatType.DIRECT)...
```

---

### ‚úì In `ChatResponse` (REST representation)

Serialized as string:
```json
{
  "type": "GROUP"
}
```

---

## üîê Design Notes
- Two simple chat types cover 95% of the messaging use cases.
- Enum approach ensures compile-time safety instead of using loosely defined strings.
- Future extensions are simple - possible additional types:
  - `CHANNEL` (broadcast-only)
  - `PRIVATE_GROUP`
  - `SUPPORT_CHAT`
  - `BOT_CONVERSATION`
- Storing enum as `STRING` in the DB ensures safer migrations and better readability.

---

## ‚úî Summary

`ChatType` defines **how a chat is structured and behaves**:

| Type      | Meaning                     | Participants | Special Rules                         |
|:----------|:----------------------------|:-------------|:--------------------------------------|
| DIRECT    | 1-to-1 private conversation | exactly 2    | cannot add/remove users               |
| GROUP     | multi-user chat room        | 2 or more    | supports admin roles & <br>membership |

It integrates with:
- `Chat` entity
- `ChatService` logic
- REST DTOs

`ChatType` is a foundational enum that governs the business rules of the entire chat module.