# 5.1 `WsMessageType`

This enum represents the **type of WebSocket message** exchanged inside a chat channel. It is used by the 
`WsChatController`, message handlers, and the frontend WebSocket client to understand the *purpose* of each message 
delivered through STOMP/WebSocket.

```java
package com.chatapp.chat.chat.ws;

public enum WsMessageType {
  CHAT,
  JOIN,
  LEAVE
}
```

---

## ğŸ“ Overview

In any real-time messaging architecture, WebSocket frames must communicate not only the message content, but also 
the *intent* behind the message.


`WsMessageType` provides this intent layer.

It tells the application whether:

- a user sent a **normal chat message**
- a user **joined** a chat
- a user **left** a chat

These types appear inside both:
- `WsInboundMessage` (incoming WebSocket payloads)
- `WsOutboundMessage` (messages broadcast by the backend)

This ensures consistent interpretation on both backend and frontend.

---

## ğŸ“Œ Enum Values Explained

### 1. `CHAT`

Represents a **regular chat message sent by a user**.

Used when:
- clients send a message via `/app/chat.sendMessage`
- `WsChatController` processes and persists the message
- the backend broadcasts a corresponding `WsOutboundMessage`
- the UI renders it as a chat bubble

### Typical JSON payload:

```json
{
  "chatId": "abc123",
  "sender": "Alice",
  "content": "Hello everyone!",
  "type": "CHAT"
}
```

**Persisted:** Yes â€” stored as a `Message` entity.

---

### 2. `JOIN`

A **system event** announcing that a user joined the chat.

Used when:
- a new user enters a chat room
- the UI should display: *"Alice joined the chat"*

Set explicitly in:
```java
wsOutboundMessage.setType(WsMessageType.JOIN);
```

### Typical UI behavior:
- grey system bubble
- not treated as a normal chat message

**Persisted:** No â€” these are real-time events only.

---

### 3. `LEAVE`

Represents a **"user left the chat"** system event.

Used when:
- a user disconnects from WebSocket
- a user manually leaves the chat
- the frontend needs to remove typing indicators or show a message such as:
    
  *"Alice left the chat."*

This is optional depending on the UI/UX but is supported by the enum.

Just like `JOIN`, these are **not persisted**, but provide valuable presence updates.

---

### Usage

- Used exclusively in WebSocket message payloads (`WsInboundMessage`, `WsOutboundMessage`).
- Helps the client distinguish between system-level updates (JOIN/LEAVE) and user-generated chat content (CHAT).

## ğŸ¯ Why This Enum Matters

### 1. Clear distinction between chat messages and system notifications
The frontend can switch on `type` to render the message appropriately.

### 2. Standardized protocol
No magic strings; types are controlled and validated.

### 3. Extensibility
Future options such as:
- `TYPING`
- `READ_RECEIPT`
- `SYSTEM`
  can be added without redesigning communication.

### 4. Strong typing = fewer bugs
Reduces ambiguity in WebSocket payload processing.

--- 

## ğŸ“¦ Where It Is Used

### Backend:

- `WsChatController.sendMessage()` (`CHAT`)
- `WsChatController.addUser()` (`JOIN`)
- future WebSocket presence handlers â†’ `LEAVE`


### Frontend:

- rendering incoming WebSocket frames
- displaying system events
- managing chat presence

---

## âœ” Summary

`WsMessageType` defines the **meaning of every WebSocket event** in the chat flow.

It provides a clean, extensible communication contract between backend and frontend, ensuring predictable handling of 
chat messages, presence notifications, and future WebSocket-based events.